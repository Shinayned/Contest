function show_BubbleNotice(text,delay){
	if(typeof delay === 'undefined'){
		delay=6000;
	}
	$('.t-help-bubble').css('display','none');
	$('body').append("<div class='cornernotice'><div class='cornernotice__close'>&times;</div><div class='cornernotice__text'>"+text+"</div></div>");
	$(".cornernotice").animate({"opacity": "100","right": "20px"}, 400,"easeInCirc", function() {
		setTimeout(function(){
			close_BubbleNotice();
		}, delay);
	});
	$('.cornernotice__close').click(function() {
		close_BubbleNotice();
	});
}
function close_BubbleNotice(){
	$(".cornernotice").animate({"opacity": "0","right": "0px"}, 300,"easeOutCirc", function() {
		$(this).remove();
		$('.t-help-bubble').css('display','block');
	});
}

function showOnboardingPin(pinid,str,left,top,elem,fixed,shiftbubbleleft,shiftbubbletop){

	if( $(window).width()<1200 )return('');

	var firstopen = localStorage.getItem('tp-pin-'+pinid);
	if(firstopen!==null){
		return;
	}

	var data='';
	data += "<div class='onboardingpin' id='"+pinid+"' data-pin-left='"+left+"' data-pin-top='"+top+"' data-pin-fixed='"+fixed+"' data-pin-elem='"+elem+"'>";
	data += "<div class='onboardingpin__wrapper'>";
	data += "<div class='onboardingpin__pin'></div>";
	data += "<div class='onboardingpin__bubble' style='" + (shiftbubbleleft>-2000 ? "left:"+shiftbubbleleft+"px;" : "") + (shiftbubbletop>-2000 ? "top:"+shiftbubbletop+"px;" : "") + "' id='"+pinid+"'>";
	data += "<div class='onboardingpin__msg'>"+str+"</div>";
	data += "<div class='onboardingpin__btn-close'>OK</div>";
	data += "</div>";
	data += "</div>";
	data += "</div>";
	$('body').prepend(data);

	var el=$("#"+pinid);
	updatePinPosition(el);

	el.mouseover(function() {
	  if( $(this).hasClass('onboardingpin_opened')===true )return('');
	  $( this ).addClass('onboardingpin_opened');
	  $(this).find(".onboardingpin__bubble").css('opacity',0);
	  $(this).find(".onboardingpin__bubble").animate({"opacity": "1"}, 500,"easeOutCirc");

	  if ( $( ".onboardingpin__filter" ).length==0 ) {
	  	$('body').prepend("<div class='onboardingpin__filter' style='opacity:0;'></div>");
	  	$(".onboardingpin__filter").animate({"opacity": "0.7"}, 300,"easeOutCirc");

		$( ".onboardingpin__filter" ).click(function() {
			closeOnboardingPinHtml();
		});
	  }
	  localStorage.setItem('tp-pin-'+pinid, Date.now() );
	});

	$( ".onboardingpin__btn-close" ).click(function() {
		closeOnboardingPinHtml();
	});

	setInterval(function() {
	  updatePinPosition(el);
	}, 2000);

}

function updatePinPosition(pin){
	var left=parseInt(pin.attr('data-pin-left'));
	var top=parseInt(pin.attr('data-pin-top'));
	var fixed=pin.attr('data-pin-fixed');

	var elem_left=0;
	var elem_top=0;
	var elem=pin.attr('data-pin-elem');
	if(elem!=''){
		if($(elem).length){
			var offset=$(elem).offset();
			elem_left=parseInt(offset.left);
			if(fixed!='fixed')elem_top=parseInt(offset.top);
		}
	}
	if(fixed=='fixed')pin.css('position','fixed');
	pin.css('left',left+elem_left+'px');
	pin.css('top',top+elem_top+'px');
}

function closeOnboardingPinHtml(el){
	  $('.onboardingpin_opened').remove();
	  $('.onboardingpin__filter').remove();
}

window.showLoadIcon = function (){
	if ($('#loadicon').length == 0) {
		$('body').append('<div id="loadicon" class="spinner"></div>');
	}
	$('#loadicon').css({"display":"block"});
}

window.hideLoadIcon = function (){
	if ($('#loadicon').length > 0) {
		$('#loadicon').css({"display":"none"});
	}
}

function check_logout(data){
	if(typeof data=='string' && data.substring(0,10)=='<!--tlp-->'){
		window.location = '/login/';
		throw new Error("Sorry, you logout!");
	}
}

/* блок подключения приемщиков */
$(document).ready(function(){
	window.simplereloadpage = function (url, sleep) {
		if (sleep && sleep > 0) {
			window.setTimeout(function(){
					if (url && url > '') {
						window.location.href = url;
					} else {
						window.location.reload();
					}
				},
				sleep
			);
		} else {
			if (url && url > '') {
				window.location.href = url;
			} else {
				window.location.reload();
			}
		}
	}

	function oauthstart_check(callback) {
		try {
			if(window.oauthstartwin && window.oauthstartwin.document){
				var elem = window.oauthstartwin.document.getElementById('messageid');
				if (elem) {
					window.hideLoadIcon();
					if (window.oauthcheck) {
						clearTimeout(window.oauthcheck);
					}
					window.oauthcheck = false;
					window.oauthstartwin.close();

					if (callback > '') {
						eval(callback+'()');
					}
					return true;
				}
			}
		} catch(e) {

		}

		window.oauthcheck = window.setTimeout(function() {
			oauthstart_check(callback);
		}, 200);
	}

	window.oauthstart = function (url, callback, title) {
		//var url='https://login.mailchimp.com/oauth2/authorize?response_type=code&client_id='+client_id+'&redirect_uri=https%3A%2F%2Ftilda.cc%2Foauth%2Fmailchimp%2F%3Fstate%3D'+user_id;
		var w = $(window).width() > 700 ? 600 : parseInt($(window).width()*0.9);
		var h = $(window).height() > 600 ? 600 :  parseInt($(window).height()*0.9);
		var params = "menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width="+w+',height='+h;


		window.showLoadIcon();

		if (!title || title == undefined) {
			title = 'OAuth2 authorization';
		}
		window.oauthstartwin = window.open(url, title, params)
		window.oauthcheck = window.setTimeout(function() {
			oauthstart_check(callback); }, 200);
	}

    var oauthCheckFunctionTry = 0;
    window.oauthCheckFunction = function () {
        try {
            oauthCheckFunctionTry++;
            if (oauthCheckFunctionTry > 5*60*15) {
                closepopup();
                alert ('Reload page and try again.');
                return ;
            }
            //console.log('oauthCheckFunction: '+oauthCheckFunctionTry);
            if (! $('body').hasClass('td-body_popup-opened') || $('#popup_oauth').css('display')=='none') {
                    //console.log('oauthCheckFunction: close popup');

                    window.hideLoadIcon();
                    if (window.oauthcheck) {
                        clearTimeout(window.oauthcheck);
                        window.oauthcheck = false;
                    }
                    return;
            }

            var ifrm = document.getElementById('oauthwindowframe');
            var win = ifrm.contentWindow; // reference to iframe's window
            // reference to document in iframe
            var doc = ifrm.contentDocument? ifrm.contentDocument: ifrm.contentWindow.document;

            if (doc) {
                //console.log('oauthCheckFunction: find doc');
                var elem = doc.getElementById('messageid');
                if (elem) {
                    //console.log('oauthCheckFunction: find message');
                    window.hideLoadIcon();
                    if (window.oauthcheck) {
                        clearTimeout(window.oauthcheck);
                        window.oauthcheck = false;
                    }
                    closepopup();

                    if (callback > '') {
                        eval(callback+'()');
                    }

                }
            } else {
                //console.log('oauthCheckFunction: not found message');

            }
        } catch(e) {
            //console.log('oauthCheckFunction: exception');
            //console.log(e);
        }

        //console.log('oauthCheckFunction: setTimeout');
        window.oauthcheck = setTimeout(oauthCheckFunction, 200);
    }

	window.oauthwindowframe = function (url, callback) {
		//var url='https://login.mailchimp.com/oauth2/authorize?response_type=code&client_id='+client_id+'&redirect_uri=https%3A%2F%2Ftilda.cc%2Foauth%2Fmailchimp%2F%3Fstate%3D'+user_id;
		var w = $(window).width() > 700 ? 600 : parseInt($(window).width()*0.9);
		var h = $(window).height() > 600 ? 600 :  parseInt($(window).height()*0.9);

		if ($('#popup_oauth').length == 0) {
			$('body').append('<div class="td-popup" id="popup_oauth" style="display: none;"><div class="td-popup__wrap"><div class="td-popup-window"><div class="td-popup-window__head"><div class="td-popup-window__close" onclick="closepopup();"></div><div class="td-popup-window__title" style="margin-bottom: 30px;">Connect to service <span id="popup_oauth_service_title"></span></div></div>  <div class="td-popup-window__middle"><div class="td-popup-window__middle-wrapper td-tab-content"><div id="tab_oauth" class="td-tab-pane td-tab-pane_active"></div></div></div> </div></div></div>');
		}
		$('#popup_oauth').data('popup-content','notdelete');
		window.showLoadIcon();
		$('#tab_oauth').html('<iframe src="'+url+'" width="'+w+'" height="'+h+'" frameborder="0" border="0" id="oauthwindowframe" name="oauthwindowframe" scrolling="auto"></iframe>');
		showpopup('#popup_oauth');

        window.oauthcheck = setTimeout(oauthCheckFunction,200);

		return false;
	}

	window.oauthCheckMailchimp = function (callback) {
		if (window.oauthcheck) {
			clearTimeout(window.oauthcheck);
			window.oauthcheck = false;
		}

		try {
			if(window.oauthmailchimpwin && window.oauthmailchimpwin.document){
				var elem = window.oauthmailchimpwin.document.getElementById('messageid');
				if (elem) {
					window.hideLoadIcon();
					window.oauthmailchimpwin.close();

					if (callback > '') {
						eval(callback+'()');
					}
					return ;
				}
			}
		} catch(e) {

		}

		window.oauthcheck = setTimeout(function(){
			oauthCheckMailchimp(callback);
		}, 200);
	};

	window.oauthmailchimp = function (url, callback) {
		//var url='https://login.mailchimp.com/oauth2/authorize?response_type=code&client_id='+client_id+'&redirect_uri=https%3A%2F%2Ftilda.cc%2Foauth%2Fmailchimp%2F%3Fstate%3D'+user_id;
		var w = $(window).width() > 700 ? 600 : parseInt($(window).width()*0.9);
		var h = $(window).height() > 600 ? 600 :  parseInt($(window).height()*0.9);
		var params = "menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width="+w+',height='+h;

		window.showLoadIcon();

		window.oauthmailchimpwin = window.open(url, "Mailchimp Open ID authorization", params)

		window.oauthcheck = setTimeout(function(){
			oauthCheckMailchimp(callback);
		}, 200);
	};

	function mailchimpgetlists() {
		var projectid = $('#allrecords').data('tilda-project-id');
		showLoadIcon();
		$.post('/projects/forms/submit/',{comm:'getlist',receivertype:'mailchimp', projectid: projectid}, function(html){
				hideLoadIcon();

				$('#selectrecieverboxid').hide();
				if (html > '' && html.substring(0,1) == '<') {
					$('#dialogrecieverboxid').show();
					$('#formcontrolrecieverboxid').html(html)
					$('#formnewrecieverboxid').find('input').removeAttr('disabled');
					$form.show();
				} else {
					if (html > '' && html.substring(0,4) == 'http') {
						oauthmailchimp(html,'mailchimpgetlists');
					} else {
						$('#formcontrolrecieverboxid').html('');
						$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
					}
				}
			},
			'html'
		);
	}

	function creategsheet() {
		var projectid = $('#allrecords').data('tilda-project-id');
		showLoadIcon();
		$.post('/projects/forms/submit/',{receivertype: 'gsheet', appid: 'new', comm:'recieveredit', projectid: projectid}, function(json){
			hideLoadIcon();
			if(json && json.message > '') {
				var recid = $('#sendformnewrecieverid').data('record-id');
				$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid green;">'+json.message+'</div>');

				if (json.result && json.result.hash) {
					var html = '<label class="pe-label"><input type="checkbox" name="formintegrations'+recid+'[]" value="'+json.result.hash+'" checked="checked"  data-form-type="'+json.result.type+'">Google Sheet: '+json.result.name+'</label>';
					$('#selectrecieverboxid').before(html);


					$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
					$('#dialogrecieverboxid').hide();
					$('#selectrecieverboxid').show();

				}


			} else {
				var error = '';
				if(json && json.error) {
					error = json.error;
				} else {
					error = json;
				}

				$('#formnewrecieverlogid').html(error);
			}
		},'json');
	}
	function creategsheetwithauth() {
		var projectid = $('#allrecords').data('tilda-project-id');
		showLoadIcon();
		$.post('/projects/forms/submit/',{comm:'getoauthurl',receivertype:'gsheet', projectid: projectid}, function(html){
				hideLoadIcon();

				$('#selectrecieverboxid').hide();
				if (html > '' && html.substring(0,4) == 'http') {
					window.oauthstart(html,'creategsheet','Google.Sheets connect');
				} else {
					$('#formcontrolrecieverboxid').html('');
					$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
				}
			},
			'html'
		);
	}

	$('body').off('change', '#selectrecieverboxid');
	$('body').on('change', '#selectrecieverboxid', function(e){
		var rtype = $(this).val();
		var lang = $(this).data('lang');
		var html = '';
		var $form = $('#dialogrecieverboxid');
		var projectid = $('#allrecords').data('tilda-project-id');
		var redirect_uri;
		$('#formnewrecieverlogid').html('');

		switch (rtype) {
			case 'js-reciever-email':
				html = '<input type="hidden" name="receivertype" value="email" class="js-not-send-on-server">';
				html += '<input type="text" name="appid" class="ss-input js-not-send-on-server" placeholder="'+(lang=='RU' ? 'Email' : 'Email')+'">';
				break;

			case 'js-reciever-mailchimp':
				showLoadIcon();
				mailchimpgetlists();
				return ;
				break;

			case 'js-reciever-gsheet':
				showLoadIcon();
				creategsheetwithauth();
				return ;
				break;

			default:
				if (rtype > '') {
					if (rtype.substring(0,2)=='js') {
						window.location.href='/projects/settings/?projectid='+projectid+'#tab=ss_menu_forms';
					} else {
						window.location.href='/projects/forms/add/?type='+rtype+'&projectid='+projectid;
					}
				}
				break;
		}

		if (html > '') {
			$(this).hide();
			$('#formcontrolrecieverboxid').html(html)
			$('#formnewrecieverboxid').find('input').removeAttr('disabled');
			$form.show();
		} else {
			$('#formcontrolrecieverboxid').html('');
			$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
		}
	});


	$('body').off('dblclick', '#sendformnewrecieverid');
	$('body').on('dblclick', '#sendformnewrecieverid', function(e){
		e.preventDefault();
		return false;
	});
	$('body').off('click', '#sendformnewrecieverid');
	$('body').on('click', '#sendformnewrecieverid', function(e){
		e.preventDefault();
		var arPosts = {};
		var lang = $(this).data('lang');
		var recid = $(this).data('record-id');
		$('#formnewrecieverlogid').html('');

		$('#formnewrecieverboxid').find('input,select').each(function(){
			if ($(this).attr('type')!='button' && $(this).attr('type')!='submit') {
				arPosts[ $(this).attr('name') ] = $(this).val();
			}
		});
		$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
		$.post('/projects/forms/submit/', arPosts, function(json){
				var error = '';

				if (! json) {
					error = (lang == 'RU' ? '' : '');
				}

				if (json && json.error) {
					error = json.error;
				}

				if (error > '') {
					$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid red;">'+error+'</div>');
					$('#formnewrecieverboxid').find('input').removeAttr('disabled');
				} else {
					if (json.message > '') {
						$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid green;">'+json.message+'</div>');

						if (json.result && json.result.hash) {
							var html = '<label class="pe-label"><input type="checkbox" name="formintegrations'+recid+'[]" value="'+json.result.hash+'" checked="checked"  data-form-type="'+json.result.type+'">'+json.result.name+'</label>';
							$('#selectrecieverboxid').before(html);


							$('#formnewrecieverboxid').find('input').attr('disabled', 'disabled');
							$('#dialogrecieverboxid').hide();
							$('#selectrecieverboxid').show();

						}
					}
				}

			},
			'json'
		).fail(function(data){
			$('#formnewrecieverboxid').find('input').removeAttr('disabled');
			if (data && typeof(data) == 'string') {
				if (data.substring(0,1) == '{') {
					data = $.parseJSON(data);
				} else {
					$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid red;">'+data+'</div>');
				}
			}
			if (data && typeof(data) != 'string') {
				if (data.error) {
					$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid red;">'+data.error+'</div>');
				} else {
					if (data.responseText) {
						$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid red;">'+data.responseText+'</div>');
					} else {
						$('#formnewrecieverlogid').html('<div style="padding: 5px 10px; border: 2px solid red;">Temprary error. Please reload page and try again.</div>');
					}
				}
			}
		});
		return false;
	});

/*
	$('body').off('submit', '#formnewrecieverboxid');
	$('body').on('submit', '#formnewrecieverboxid', function(e){
		e.preventDefault();
		alert('submit');
		return false;
	});
*/
});


	function showHelpBubble(){
		var str='';
		str="<div class='t-help-bubble' style='position:fixed;bottom:30px;right:30px; border-radius:100px;width:60px;height:60px;background-color:rgba(250, 134, 105, 0.9);z-index:3000;box-shadow: 0px 0px 8px 0px rgba(0,0,0,0.2);cursor:pointer;' onclick='showHelpPanel();'><img src='/tpl/img/basic_question_1.svg' style='width:60px;height:60px;'></div>";
		$('body').append(str);
	}

	function showHelpPanel(){
		$('.t-help-bubble').css('display','none');

		var it=[];
		if(lang=='RU'){
			var topics={
				0:{
					title:"Как устроен интерфейс",
					link:"",
					items:{
						0:{
							title:"Как работать в Тильде",
							link:"http://help-ru.tilda.ws/getstarted"
						}
					}
				},
				1:{
					title:"Домен",
					link:"",
					items:{
						0:{
							title:"Как подключить домен",
							link:"http://help-ru.tilda.ws/customdomain"
						},
						1:{
							title:"Домен не работает",
							link:"http://help-ru.tilda.ws/customdomain-errors"
						},
						2:{
							title:"Сайт не открывается",
							link:"http://help-ru.tilda.ws/not-working"
						},
						3:{
							title:"Как подключить почту для домена",
							link:"http://help-ru.tilda.ws/mail-domain"
						},
						4:{
							title:"Как настроить протокол HTTPS",
							link:"http://help-ru.tilda.ws/https"
						},
						5:{
							title:"Как подтвердить право на домен",
							link:"http://help-ru.tilda.ws/domain-confirm"
						},
						6:{
							title:"Бесплатный субдомен на tilda.ws",
							link:"http://help-ru.tilda.ws/address"
						},
						7:{
						    title:"Как купить домен",
						    link:"http://help-ru.tilda.ws/domain"
						},
						8:{
						    title:"Как получить домен в подарок",
						    link:"https://tilda.cc/ru/free-domain/"
						}
					}
				},
				2:{
					title:"Настройки сайта",
					link:"",
					items:{
						0:{
							title:"Как назначить главную страницу сайта",
							link:"http://help-ru.tilda.ws/homepage"
						},
						1:{
							title:"Как сделать шапку и подвал (header и footer)",
							link:"http://help-ru.tilda.ws/header-footer"
						},
						2:{
							title:"Как поменять шрифт",
							link:"http://help-ru.tilda.ws/fonts"
						},
						3:{
							title:"Шрифты не отображаются",
							link:"http://help-ru.tilda.ws/why-font-not-work"
						},
						4:{
							title:"Как поменять цвет ссылок, шрифта и фона",
							link:"http://help-ru.tilda.ws/colors"
						},
						5:{
							title:"Бесплатный субдомен на tilda.ws",
							link:"http://help-ru.tilda.ws/address"
						},
						6:{
							title:"Как создать папки",
							link:"http://help-ru.tilda.ws/folders"
						},
						7:{
							title:"Как передать сайт на другой аккаунт",
							link:"http://help-ru.tilda.ws/transfer"
						},
						8:{
							title:"Как добавить пиксель для Facebook и Vk",
							link:"http://help-ru.tilda.ws/facebook-pixel"
						},
						9:{
							title:"Как сделать мультиязычный сайт",
							link:"http://help-ru.tilda.ws/bilingual"
						},
						10:{
							title:"A/B тестирование",
							link:"http://help-ru.tilda.ws/abtest"
						},
						11:{
							title:"Добавление HTML в HEAD сайта или страницы",
							link:"http://help-ru.tilda.ws/html#head"
						},
						12:{
							title:"Ограничение доступа к сайту",
							link:"http://help-ru.tilda.ws/limited-access"
						}
					}
				},
				3:{
					title:"Редактирование страницы",
					link:"",
					items:{
						0:{
							title:"Как опубликовать страницу",
							link:"http://help-ru.tilda.ws/published"
						},
						1:{
							title:"Не видны изменения после публикации",
							link:"http://help-ru.tilda.ws/published#rec15475933"
						},
						2:{
							title:"Как сделать меню сайта",
							link:"http://help-ru.tilda.ws/menu"
						},
						3:{
							title:"Якоря и ссылки внутри страницы",
							link:"http://help-ru.tilda.ws/anchor"
						},
						4:{
							title:"Действия со страницей: создание, копирование, передача",
							link:"http://help-ru.tilda.ws/page-actions"
						},
						5:{
							title:"Ссылки на другие страницы. Публичные адреса",
							link:"http://help-ru.tilda.ws/link-to-page"
						},
						6:{
							title:"Как создать собственный блок",
							link:"http://help-ru.tilda.ws/zero"
						},
						7:{
							title:"Работа с обложкой",
							link:"http://help-ru.tilda.ws/cover"
						},
						8:{
							title:"Как добавить всплывающее окно (popup)",
							link:"http://help-ru.tilda.ws/popups"
						},
						9:{
							title:"Как добавить виджет обратной связи",
							link:"http://help-ru.tilda.ws/callback"
						},
						10:{
							title:"Как добавить HTML код",
							link:"http://help-ru.tilda.ws/html"
						},
						11:{
							title:"Как настроить форму",
							link:"http://help-ru.tilda.ws/forms-settings"
						},
						12:{
							title:"Публикация на Facebook",
							link:"http://help-ru.tilda.ws/metadate"
						},
						13:{
							title:"Как сделать кликабельный телефон или email",
							link:"http://help-ru.tilda.ws/clickable-contacts"
						},
						14:{
							title:"Корректировка мобильной версии",
							link:"http://help-ru.tilda.ws/mobile-version"
						},
						15:{
							title:"Оптимизация изображений для сайта",
							link:"http://help-ru.tilda.ws/photo-for-publishing"
						},
						16:{
							title:"Как создать свой шаблон",
							link:"http://help-ru.tilda.ws/page-template"
						},
						17:{
							title:"Как сделать блог",
							link:"http://tilda.education/tutorialsblog"
						},
						18:{
							title:"Неразрывный пробел и мягкий перенос",
							link:"http://help-ru.tilda.ws/unbroken-space"
						},
						19:{
							title:"Подключение комментариев",
							link:"http://help-ru.tilda.ws/disqus"
						},
						20:{
							title:"Как добавить поиск на сайт",
							link:"http://help-ru.tilda.ws/search"
						},
						21:{
							title:"Как сделать онлайн-запись",
							link:"http://help-ru.tilda.ws/online-booking"
						},
						22:{
							title:"Всплывающая подсказка (Tooltip)",
							link:"http://help-ru.tilda.ws/tooltip"
						},
						23:{
							title:"Как добавить микроразметку",
							link:"http://help-ru.tilda.ws/microdata"
						},
						24:{
							title:"Блоки из категории «Список страниц»",
							link:"http://help-ru.tilda.ws/indexvideo"
						},
						25:{
							title:"Как исправить отображение ссылки на сайт в соцсетях",
							link:"http://help-ru.tilda.ws/preview-update"
						},
						26:{
							title:"Микроанимация загрузки и прокрутки страницы",
							link:"http://help-ru.tilda.ws/page-loading-page-scrolling-indicator"
						},
						27:{
							title:"Как сохранить страницу в PDF",
							link:"http://help-ru.tilda.ws/save-as-pdf"
						},
						28:{
							title:"Как создать ленту RSS",
							link:"http://help-ru.tilda.ws/rss"
						},
						29:{
							title:"Мультилендинг, геолендинг и замена языковой версии",
							link:"http://help-ru.tilda.ws/multilanding-geolanding"
						},
						30:{
							title:"Как добавить фотографии из Instagram",
							link:"http://help-ru.tilda.ws/how-to-add-instagram-photos"
						}
					}
				},
				4:{
					title:"Интернет-магазин",
					link:"",
					items:{
						0:{
							title:"Как создать интернет-магазин",
							link:"http://help-ru.tilda.ws/online-store-payments"
						},
						1:{
							title:"Как добавить товары",
							link:"http://help-ru.tilda.ws/online-store-payments/catalog"
						},
						2:{
							title:"Как сделать категории",
							link:"http://help-ru.tilda.ws/online-store-payments/catalog-category"
						},
						3:{
							title:"Как работать с корзиной",
							link:"http://help-ru.tilda.ws/online-store-payments/cart"
						},
						4:{
							title:"Продажа без корзины",
							link:"http://help-ru.tilda.ws/online-store-payments/direct-sale"
						},
						5:{
							title:"Как подключить платежную систему",
							link:"http://help-ru.tilda.ws/online-store-payments/payment-system"
						},
						5:{
							title:"Платежи не проходят",
							link:"http://help-ru.tilda.ws/payments-errors"
						},
						6:{
							title:"Как отправлять уведомления о заказе",
							link:"http://help-ru.tilda.ws/online-store-payments/notifications"
						},
						7:{
							title:"Продажа товаров без оплаты онлайн",
							link:"http://help-ru.tilda.ws/online-store-payments/without-payment"
						},
						8:{
							title:"Как добавить выбор параметров товара",
							link:"http://help-ru.tilda.ws/online-store-payments/parameters"
						},
						9:{
							title:"Как добавить дополнительные товары",
							link:"http://help-ru.tilda.ws/online-store-payments/additional-goods"
						},
						10:{
							title:"Как добавить варианты доставки",
							link:"http://help-ru.tilda.ws/online-store-payments/shipping"
						},
						11:{
							title:"Как сделать промокод",
							link:"http://help-ru.tilda.ws/online-store-payments/promo-codes"
						},
						12:{
							title:"Как передавать данные для онлайн-кассы",
							link:"http://help-ru.tilda.ws/online-store-payments/online-kassa"
						}
					}
				},
				5:{
					title:"Формы",
					link:"",
					items:{
						0:{
							title:"Формы приема данных: добавление, настройка, подключение сервисов.",
							link:"http://help-ru.tilda.ws/forms"
						},
						1:{
							title:"Не приходят заявки",
							link:"http://help-ru.tilda.ws/forms-errors"
						},
						2:{
							title:"Как отправлять данные на Email",
							link:"http://help-ru.tilda.ws/formsemail"
						},
						3:{
							title:"Как отправлять данные в Google Таблицу",
							link:"http://help-ru.tilda.ws/formsgooglesheets"
						},
						4:{
							title:"Как отправлять данные в MailChimp",
							link:"http://help-ru.tilda.ws/formsmailchimp"
						},
						5:{
							title:"Как отправлять данные в Telegram",
							link:"http://help-ru.tilda.ws/formstelegram"
						},
						6:{
							title:"Как отправлять данные в Google Forms",
							link:"http://help-ru.tilda.ws/formsgoogle"
						},
						7:{
							title:"Отправка данных формы на почту через SendGrid",
							link:"http://help-ru.tilda.ws/formssendgrid"
						},
						8:{
							title:"Как отправлять данные в GetResponse",
							link:"http://help-ru.tilda.ws/formsgetresponse"
						},
						9:{
							title:"Как отправлять данные в UniSender",
							link:"http://help-ru.tilda.ws/formsunisender"
						},
						10:{
							title:"Как отправлять данные в SendinBlue",
							link:"http://help-ru.tilda.ws/formssendinblue"
						},
						11:{
							title:"Как отправлять данные в AmoCRM",
							link:"http://help-ru.tilda.ws/formsamo"
						},
						12:{
							title:"Как отправлять данные в Мегаплан",
							link:"http://help-ru.tilda.ws/formsmegaplan"
						},
						13:{
							title:"Как отправлять данные в Битрикс24",
							link:"http://help-ru.tilda.ws/formsbitrix"
						},
						14:{
							title:"Как отправлять данные в Trello",
							link:"http://help-ru.tilda.ws/formstrello"
						},
						15:{
							title:"Как отправлять данные в Slack",
							link:"http://help-ru.tilda.ws/formsslack"
						},
						16:{
							title:"Как отправлять данные в любой сервис через Zapier",
							link:"http://help-ru.tilda.ws/formszapier"
						},
						17:{
							title:"Webhook: прием данных из форм на свой скрипт",
							link:"http://help-ru.tilda.ws/formswebhook"
						},
						18:{
							title:"Подключение собственного скрипта напрямую",
							link:"http://help-ru.tilda.ws/formsscript"
						},
						19:{
							title:"Cтраница благодарности (успеха)",
							link:"http://help-ru.tilda.ws/thank-you-page"
						}
					}
				},
				6:{
					title:"Статистика",
					link:"",
					items:{
						0:{
							title:"Как посмотреть статистику",
							link:"http://help-ru.tilda.ws/statistic"
						},
						1:{
							title:"Как подключить Яндекс.Метрику",
							link:"http://help-ru.tilda.ws/statistic/yandex-metrika"
						},
						2:{
							title:"Как подключить Google Analytics",
							link:"http://help-ru.tilda.ws/statistic/google-analytics"
						},
						3:{
							title:"Как настроить Google Tag Manager",
							link:"http://help-ru.tilda.ws/googletagmanager"
						},
						4:{
							title:"Как отправлять данные о достижении цели",
							link:"http://help-ru.tilda.ws/statistics-goal"
						},
						5:{
							title:"Статистика открытий попапа",
							link:"http://help-ru.tilda.ws/statistics-goal#popup"
						},
						6:{
							title:"Статистика нажатий на кнопку",
							link:"http://help-ru.tilda.ws/statistics-goal#button"
						},
						7:{
							title:"Статистика заполнения формы",
							link:"http://help-ru.tilda.ws/statistics-goal#form"
						},
						8:{
							title:"Статистика по корзине",
							link:"http://help-ru.tilda.ws/statistics-goal#cart"
						}
					}
				},
				7:{
					title:"SEO",
					link:"",
					items:{
						0:{
							title:"Гид по SEO: продвижение сайта",
							link:"http://help-ru.tilda.ws/search-engine"
						},
						1:{
							title:"Чек-лист по SEO-оптимизации сайта",
							link:"http://help-ru.tilda.ws/search-engine#check-list"
						},
						2:{
							title:"Как добавить сайт в Google и Яндекс",
							link:"http://help-ru.tilda.ws/search-engine#google-yandex"
						},
						3:{
							title:"Тильда-панель вебмастера. Инструмент для SEO",
							link:"http://help-ru.tilda.ws/search-engine#tilda-webmaster"
						},
						4:{
							title:"Как задать страницам сайта название (Title) и описание (Description)",
							link:"http://help-ru.tilda.ws/search-engine#title-description"
						},
						5:{
							title:"Как добавить тег H1, H2, H3",
							link:"http://help-ru.tilda.ws/search-engine#h1"
						},
						6:{
							title:"Как добавить фавикон (favicon)",
							link:"http://help-ru.tilda.ws/search-engine#favicon"
						},
						7:{
							title:"Как сделать читаемые адреса страниц (ЧПУ, человекопонятный URL)",
							link:"http://help-ru.tilda.ws/search-engine#friendly-url"
						},
						8:{
							title:"Как изменить название сайта на вкладке браузера",
							link:"http://help-ru.tilda.ws/search-engine#site-name"
						},
						9:{
							title:"Как сделать 301 редирект",
							link:"http://help-ru.tilda.ws/search-engine#redirect-https"
						},
						10:{
							title:"Файлы robots.txt и sitemap.xml",
							link:"http://help-ru.tilda.ws/search-engine#robots-sitemap"
						},
						11:{
							title:"Как сделать страницу ошибки 404",
							link:"http://help-ru.tilda.ws/search-engine#404"
						},
						12:{
							title:"Запрет индексации страницы или сайта",
							link:"http://help-ru.tilda.ws/search-engine#noindex"
						},
						13:{
							title:"Как исключить из поиска неправильную ссылку на сайт",
							link:"http://help-ru.tilda.ws/how-to-remove-link"
						}
					}
				},
				8:{
					title:"Zero Block",
					link:"",
					items:{
						0:{
							title:"Zero Block: создание собственных блоков",
							link:"http://help-ru.tilda.ws/zero"
						},
						1:{
							title:"Отзывчивый дизайн в Zero Block",
							link:"http://help-ru.tilda.ws/zero-block-advanced"
						},
						2:{
							title:"Список горячих клавиш в Zero Block",
							link:"http://help-ru.tilda.ws/zero-block-shortcuts"
						},
						3:{
							title:"Анимация в Zero Block",
							link:"http://help-ru.tilda.ws/zero-block-animation"
						}
					}
				},
				9:{
					title:"Конструктор писем",
					link:"",
					items:{
						0:{
							title:"Презентация конструктора писем",
							link:"https://tilda.cc/ru/lp/email-campaign-builder/"
						},
						1:{
							title:"Как создать, отредактировать и отправить рассылку на Тильде",
							link:"http://help-ru.tilda.ws/email-campaign-builder"
						}
					}
				},
				10:{
					title:"Тарифы и платежи",
					link:"",
					items:{
						0:{
							title:"Тарифные планы",
							link:"https://tilda.cc/ru/pricing/"
						},
						1:{
							title:"Как перейти с тарифа Personal на Business",
							link:"http://help-ru.tilda.ws/subscription#personaltobusiness"
						},
						2:{
							title:"Как юрлицу оплатить безналично",
							link:"http://help-ru.tilda.ws/subscription#beznal"
						},
						3:{
							title:"Подтверждение оплаты и закрывающие документы (акты)",
							link:"http://help-ru.tilda.ws/subscription#confirm"
						},
						4:{
							title:"Как отменить автопродление",
							link:"http://help-ru.tilda.ws/subscription#renew"
						},
						5:{
							title:"Как расширить аккаунт до 10, 15 и 20 сайтов",
							link:"http://help-ru.tilda.ws/subscription#special"
						}
					}
				},
				11:{
					title:"Разработчикам",
					link:"",
					items:{
						0:{
							title:"Как добавить HTML код на страницу",
							link:"http://help-ru.tilda.ws/html"
						},
						1:{
							title:"Как добавить HTML в HEAD сайта или страницы",
							link:"http://help-ru.tilda.ws/html#head"
						},
						2:{
							title:"Экспорт кода",
							link:"http://help-ru.tilda.ws/export"
						},
						3:{
							title:"Свой скрипт приема данных из форм",
							link:"http://help-ru.tilda.ws/formswebhook"
						},
						4:{
							title:"Взаимодействие по API",
							link:"http://help-ru.tilda.ws/api"
						}
					}
				},
				12:{
					title:"Видеоуроки",
					link:"",
					items:{
						0:{
							title:"Видеогид по основным функциям",
							link:"http://help-ru.tilda.ws/getstarted#videoguide"
						},
						1:{
							title:"Как сделать одностраничный сайт",
							link:"http://tilda.education/tutorialsonepagesite"
						},
						2:{
							title:"Как сделать интернет-магазин",
							link:"http://tilda.education/tutorialsstore"
						},
						3:{
							title:"Работа с Zero Block",
							link:"http://help-ru.tilda.ws/zero#video"
						},
						4:{
							title:"Как сделать блог",
							link:"http://tilda.education/tutorialsblog"
						},
						5:{
							title:"Как сделать статью",
							link:"http://tilda.education/tutorialsarticle"
						},
						6:{
							title:"Работа с конструктором писем",
							link:"http://help-ru.tilda.ws/email-campaign-builder#video"
						},
						7:{
							title:"Бесплатные вебинары: расписание, прошлые выпуски",
							link:"http://webinars.tilda.cc"
						}
					}
				}
			};

			it[0]={'title':'Как устроен интерфейс','link':'http://help-ru.tilda.ws/getstarted'};
			it[1]={'title':'Редактирование страницы','link':'http://help-ru.tilda.ws/#page'};
			it[2]={'title':'Настройки сайта','link':'http://help-ru.tilda.ws/#site'};
			it[3]={'title':'Тарифы и платежи','link':'http://help-ru.tilda.ws/#price'};
			it[4]={'title':'Уроки и статьи','link':'http://help-ru.tilda.ws/#education'};

		}else{

			var topics={
				0:{
					title:"How Tilda works",
					link:"",
					items:{
						0:{
							title:"Getting started",
							link:"http://help.tilda.ws/getstarted"
						}
					}
				},
				1:{
					title:"Domain",
					link:"",
					items:{
						0:{
							title:"Assigning own domain",
							link:"http://help.tilda.ws/customdomain"
						},
						1:{
							title:"Custom domain errors",
							link:"http://help.tilda.ws/customdomain-errors"
						},
						2:{
							title:"A website doesn't work",
							link:"http://help.tilda.ws/not-working"
						},
						3:{
							title:"How to use mail with your own custom domain",
							link:"http://help.tilda.ws/mail-domain"
						},
						4:{
							title:"Configuring HTTPS on your website",
							link:"http://help.tilda.ws/https"
						},
						5:{
							title:"How to confirm your customer's domain ownership",
							link:"http://help.tilda.ws/domain-confirm"
						},
						6:{
							title:"Free subdomain on tilda.ws",
							link:"http://help.tilda.ws/address"
						},
						7:{
						    title:"How to buy a domain name",
						    link:"http://help.tilda.ws/domain"
						}
					}
				},
				2:{
					title:"Site Settings",
					link:"",
					items:{
						0:{
							title:"Assigning the Home Page",
							link:"http://help.tilda.ws/home-page"
						},
						1:{
							title:"How to add header and footer",
							link:"http://help.tilda.ws/header-footer"
						},
						2:{
							title:"How to change fonts",
							link:"http://help.tilda.ws/fonts"
						},
						3:{
							title:"My site displays incorrect fonts",
							link:"http://help.tilda.ws/why-font-not-work"
						},
						4:{
							title:"Set color of the font, headlines, links and background",
							link:"http://help.tilda.ws/colors"
						},
						5:{
							title:"Free subdomain on tilda.ws",
							link:"http://help.tilda.ws/address"
						},
						6:{
							title:"How to create folders",
							link:"http://help.tilda.ws/folders"
						},
						7:{
							title:"Handing website over to another user",
							link:"http://help.tilda.ws/transfer"
						},
						8:{
							title:"How to add a Facebook pixel",
							link:"http://help.tilda.ws/facebook-pixel"
						},
						9:{
							title:"How to make a mutli-lingual website",
							link:"http://help.tilda.ws/bilingual"
						},
						10:{
							title:"A/B testing",
							link:"http://help.tilda.ws/abtest"
						},
						11:{
							title:"How to insert HTML code in head",
							link:"http://help.tilda.ws/html#head"
						},
						12:{
							title:"How to restrict access to a website",
							link:"http://help.tilda.ws/limited-access"
						}
					}
				},
				3:{
					title:"Page Editing",
					link:"",
					items:{
						0:{
							title:"Page Publishing",
							link:"http://help.tilda.ws/published"
						},
						1:{
							title:"I don’t see changes after publishing",
							link:"http://help.tilda.ws/published#rec15478066"
						},
						2:{
							title:"How to add a menu",
							link:"http://help.tilda.ws/menu"
						},
						3:{
							title:"Anchors and internal links",
							link:"http://help.tilda.ws/anchor"
						},
						4:{
							title:"Page action: creating, duplicating, change owner",
							link:"http://help.tilda.ws/page-actions"
						},
						5:{
							title:"URLs and links to other pages",
							link:"http://help.tilda.ws/link-to-page"
						},
						6:{
							title:"Creating your own blocks",
							link:"http://help.tilda.ws/zero"
						},
						7:{
							title:"How to pitch your cover",
							link:"http://help.tilda.ws/cover"
						},
						8:{
							title:"How to add pop-ups",
							link:"http://help.tilda.ws/popups"
						},
						9:{
							title:"Feedback Widgets",
							link:"http://help.tilda.ws/callback"
						},
						10:{
							title:"How to insert HTML code",
							link:"http://help.tilda.ws/html"
						},
						11:{
							title:"Setting up forms",
							link:"http://help.tilda.ws/forms-settings"
						},
						12:{
							title:"Publishing on Facebook ",
							link:"http://help.tilda.ws/metadate"
						},
						13:{
							title:"How to add clickable phone numbers or email",
							link:"http://help.tilda.ws/clickable-contacts"
						},
						14:{
							title:"Adjusting your website for mobile view",
							link:"http://help.tilda.ws/mobile-version"
						},
						15:{
							title:"Adjusting pictures for publication",
							link:"http://help.tilda.ws/photo-for-publishing"
						},
						16:{
							title:"How to create your own template",
							link:"http://help.tilda.ws/page-template"
						},
						17:{
							title:"How to create a blog",
							link:"https://help.tilda.ws/index"
						},
						18:{
							title:"Non-Breaking Space & Soft Hyphen",
							link:"http://help.tilda.ws/unbroken-space"
						},
						19:{
							title:"Setting up Comment Section",
							link:"http://help.tilda.ws/disqus"
						},
						20:{
							title:"How to add a search bar",
							link:"http://help.tilda.ws/search"
						},
						21:{
							title:"Tooltip",
							link:"http://help.tilda.ws/tooltip"
						},
						22:{
							title:"How to set of extensible schemas",
							link:"http://help.tilda.ws/microdata"
						},
						23:{
							title:"Posting list or index page",
							link:"https://help.tilda.ws/index"
						},
						24:{
							title:"How to update a website preview on social networks",
							link:"http://help.tilda.ws/preview-update"
						},
						25:{
							title:"Microanimation of page loading and scrolling",
							link:"http://help.tilda.ws/page-loading-page-scrolling-indicator"
						},
						26:{
							title:"How to save page as PDF file",
							link:"http://help.tilda.ws/save-as-pdf"
						},
						27:{
							title:"How to create RSS feed",
							link:"http://help.tilda.ws/rss"
						},
						28:{
							title:"Multiple and geo-targeted landing pages, and changing the language",
							link:"http://help.tilda.ws/multilanding-geolanding"
						},
						29:{
							title:"How to add Instagram feed to your website",
							link:"http://help.tilda.ws/how-to-add-instagram-photos"
						}
					}
				},
				4:{
					title:"Online Store",
					link:"",
					items:{
						0:{
							title:"How to create online store",
							link:"http://help.tilda.ws/online-store-payments"
						},
						1:{
							title:"How to add products",
							link:"http://help.tilda.ws/online-store-payments/catalog"
						},
						2:{
							title:"How to create catalog",
							link:"http://help.tilda.ws/online-store-payments/catalog-category"
						},
						3:{
							title:"How to work with a cart",
							link:"http://help.tilda.ws/online-store-payments/cart"
						},
						4:{
							title:"How to sell without a cart",
							link:"http://help.tilda.ws/online-store-payments/direct-sale"
						},
						5:{
							title:"How to assign payment system",
							link:"http://help.tilda.ws/online-store-payments/payment-system"
						},
						5:{
							title:"Online payments troubleshooting",
							link:"http://help.tilda.ws/payments-errors"
						},
						6:{
							title:"How to send notifications about the order",
							link:"http://help.tilda.ws/online-store-payments/notifications"
						},
						7:{
							title:"How to sell without online payment",
							link:"http://help.tilda.ws/online-store-payments/without-payment"
						},
						8:{
							title:"How to add product parameters",
							link:"http://help.tilda.ws/online-store-payments/parameters"
						},
						9:{
							title:"How to add complementary products",
							link:"http://help.tilda.ws/online-store-payments/additional-goods"
						},
						10:{
							title:"How to add shipping options",
							link:"http://help.tilda.ws/online-store-payments/shipping"
						},
						11:{
							title:"How to create a promo code",
							link:"http://help.tilda.ws/online-store-payments/promo-codes"
						}
					}
				},
				5:{
					title:"Forms",
					link:"",
					items:{
						0:{
							title:"Forms: adding, adjusting, services assing",
							link:"http://help.tilda.ws/forms"
						},
						1:{
							title:"Form submissions are not sending",
							link:"http://help.tilda.ws/forms-errors"
						},
						2:{
							title:"How to send data to Email",
							link:"http://help.tilda.ws/formsemail"
						},
						3:{
							title:"How to send data to Google Sheets",
							link:"http://help.tilda.ws/formsgooglesheets"
						},
						4:{
							title:"How to send data to MailChimp",
							link:"http://help.tilda.ws/formsmailchimp"
						},
						5:{
							title:"How to send data to Telegram",
							link:"http://help.tilda.ws/formstelegram"
						},
						6:{
							title:"How to send data to Google Forms",
							link:"http://help.tilda.ws/formsgoogle"
						},
						7:{
							title:"Receiving captured data via SendGrid",
							link:"http://help.tilda.ws/formssendgrid"
						},
						8:{
							title:"How to send data to UniSender",
							link:"http://help.tilda.ws/formsunisender"
						},
						9:{
							title:"How to send data to SendinBlue",
							link:"http://help.tilda.ws/formssendinblue"
						},
						10:{
							title:"How to send data to Trello",
							link:"http://help.tilda.ws/formstrello"
						},
						11:{
							title:"How to send data to Slack",
							link:"http://help.tilda.ws/formsslack"
						},
						12:{
							title:"How to send data to any services via Zapier",
							link:"http://help.tilda.ws/formszapier"
						},
						13:{
							title:"Webhook: receiving data to your script",
							link:"http://help.tilda.ws/formswebhook"
						},
						14:{
							title:"Connecting your script directly",
							link:"http://help.tilda.ws/formsscript"
						},
						15:{
							title:"How to create 'Thank You Page'",
							link:"http://help.tilda.ws/thank-you-page"
						}
					}
				},
				6:{
					title:"Statistics",
					link:"",
					items:{
						0:{
							title:"How to view site statistics",
							link:"http://help.tilda.ws/statistic"
						},
						1:{
							title:"How to add Google Analytics",
							link:"http://help.tilda.ws/statistic/google-analytics"
						},
						2:{
							title:"How to add Google Tag Manager",
							link:"http://help.tilda.ws/googletagmanager"
						},
						3:{
							title:"How to submit the goal completion rates",
							link:"http://help.tilda.ws/statistics-goal"
						},
						4:{
							title:"How to view pop-up impressions",
							link:"http://help.tilda.ws/statistics-goal#popup"
						},
						5:{
							title:"How to check button clicks stats",
							link:"http://help.tilda.ws/statistics-goal#button"
						},
						6:{
							title:"How to see the number of form completions",
							link:"http://help.tilda.ws/statistics-goal#form"
						},
						7:{
							title:"How to see cart statistics",
							link:"http://help.tilda.ws/statistics-goal#cart"
						}
					}
				},
				7:{
					title:"SEO",
					link:"",
					items:{
						0:{
							title:"SEO Guide: website promotion",
							link:"http://help.tilda.ws/search-engine"
						},
						1:{
							title:"SEO Checklist",
							link:"http://help.tilda.ws/search-engine#check-list"
						},
						2:{
							title:"How to add a website to Google",
							link:"http://help.tilda.ws/search-engine#google"
						},
						3:{
							title:"Tilda webmaster console. The tool for SEO",
							link:"http://help.tilda.ws/search-engine#tilda-webmaster"
						},
						4:{
							title:"How to add tag Title and Description for a page",
							link:"http://help.tilda.ws/search-engine#title-description"
						},
						5:{
							title:"How to add tag H1, H2, H3",
							link:"http://help.tilda.ws/search-engine#h1"
						},
						6:{
							title:"How to add favicon",
							link:"http://help.tilda.ws/search-engine#favicon"
						},
						7:{
							title:"How to create User-Friendly URL",
							link:"http://help.tilda.ws/search-engine#friendly-url"
						},
						8:{
							title:"How to change website name in browser tab",
							link:"http://help.tilda.ws/search-engine#site-name"
						},
						9:{
							title:"How to create 301 redirect",
							link:"http://help.tilda.ws/search-engine#redirect-https"
						},
						10:{
							title:"Files robots.txt and sitemap.xml",
							link:"http://help.tilda.ws/search-engine#robots-sitemap"
						},
						11:{
							title:"How to create a 404 error page",
							link:"http://help.tilda.ws/search-engine#404"
						},
						12:{
							title:"Block search indexing",
							link:"http://help.tilda.ws/search-engine#noindex"
						}
					}
				},
				8:{
					title:"Zero Block",
					link:"",
					items:{
						0:{
							title:"Zero Block: creating your own blocks",
							link:"http://help.tilda.ws/zero"
						},
						1:{
							title:"Zero Block: Responsive Design",
							link:"http://help.tilda.ws/zero-block-advanced"
						},
						2:{
							title:"Zero Block: Keyboard Shortcuts List",
							link:"http://help.tilda.ws/zero-block-shortcuts"
						},
						3:{
							title:"Zero Block: animation",
							link:"http://help.tilda.ws/zero-block-animation"
						}
					}
				},
				9:{
					title:"Email Campaign Builder",
					link:"",
					items:{
						0:{
							title:"Email Campaign Builder presentation",
							link:"https://tilda.cc/lp/email-campaign-builder/"
						},
						1:{
							title:"How to create, edit and send Email newsletters",
							link:"http://help.tilda.ws/email-campaign-builder"
						}
					}
				},
				10:{
					title:"Plans and Billing",
					link:"",
					items:{
						0:{
							title:"Pricing plans",
							link:"https://tilda.cc/pricing/"
						},
						1:{
							title:"Upgrade to Business Plan",
							link:"http://help.tilda.ws/subscription#personaltobusiness"
						},
						2:{
							title:"How to cancel automatic license renewal",
							link:"http://help.tilda.ws/subscription#renew"
						},
						3:{
							title:"How to upgrade plan to 10, 15 and 20 websites",
							link:"http://help.tilda.ws/subscription#special"
						}
					}
				},
				11:{
					title:"For Developers",
					link:"",
					items:{
						0:{
							title:"How to insert HTML code",
							link:"http://help.tilda.ws/html"
						},
						1:{
							title:"How to insert HTML code in head of a website or page",
							link:"http://help.tilda.ws/html#head"
						},
						2:{
							title:"Code Export",
							link:"http://help.tilda.ws/export"
						},
						3:{
							title:"Receiving data from forms to your script",
							link:"http://help.tilda.ws/formswebhook"
						},
						4:{
							title:"Interaction with API",
							link:"http://help.tilda.ws/api"
						}
					}
				}
			}

			it[0]={'title':'Get Started','link':'http://help.tilda.ws/getstarted'};
			it[1]={'title':'Page Editing','link':'http://help.tilda.ws/#rec2090036'};
			it[2]={'title':'Site Settings','link':'http://help.tilda.ws/#rec2090043'};
			it[3]={'title':'Price and billings','link':'http://help.tilda.ws/#rec2090051'};
		}

		if(lang=='RU'){
			var q={
				0:{
					title:"Подключение домена",
					link:"http://help-ru.tilda.ws/customdomain"
				},
				1:{
					title:"Прием данных из форм",
					link:"http://help-ru.tilda.ws/forms"
				},
				2:{
					title:"Форма не работает",
					link:"http://help-ru.tilda.ws/forms-errors"
				},
				3:{
					title:"Создание интернет-магазина",
					link:"http://help-ru.tilda.ws/payments"
				},
				4:{
					title:"Создание меню сайта",
					link:"http://help-ru.tilda.ws/menu"
				},
				5:{
					title:"Изменение тарифного плана",
					link:"http://help-ru.tilda.ws/subscription#personaltobusiness"
				},
				6:{
					title:"Как отключить лейбл Made on Tilda",
					link:"http://help-ru.tilda.ws/white-label"
				},
				7:{
					title:"Не видны изменения после публикации",
					link:"http://help-ru.tilda.ws/published"
				},
				8:{
					title:"Добавление своего шрифта",
					link:"http://help-ru.tilda.ws/fonts"
				},
				9:{
					title:"Вставка своего html-кода",
					link:"http://help-ru.tilda.ws/html"
				},
				10:{
					title:"Действия со страницей",
					link:"http://help-ru.tilda.ws/page-actions"
				},
				11:{
					title:"Найти дизайнера",
					link:"https://experts.tilda.cc/ru"
				},				
			};
		}else{
			var q={
				0:{
					title:"Assigning own domain",
					link:"http://help.tilda.ws/customdomain"
				},
				1:{
					title:"Set project fonts",
					link:"http://help.tilda.ws/fonts"
				},
				2:{
					title:"Data input fields",
					link:"http://help.tilda.ws/forms"
				},
				3:{
					title:"Creating online store",
					link:"http://help.tilda.ws/payments"
				},
				4:{
					title:"Page Actions",
					link:"http://help.tilda.ws/page-actions"
				},
				5:{
					title:"Creating website menu",
					link:"http://help.tilda.ws/menu"
				},
				6:{
					title:"Upgrade to Business Plan",
					link:"http://help.tilda.ws/subscription#personaltobusiness"
				},
				7:{
					title:"How to insert html code",
					link:"http://help.tilda.ws/html"
				},
				8:{
					title:"There are no changes after publishing",
					link:"http://help.tilda.ws/published"
				},
				9:{
					title:"How to remove label Made on Tilda",
					link:"http://help.tilda.ws/white-label"
				},
			};
		}

		var str='';
		str += '<div class="tc-help">';
		str += '<div class="tc-help__body">';

			str += '<div class="tc-help__header">';
			str += '	<div class="tc-help__header-title-wrapper"><div class="tc-help__header-title">'+ (lang=="RU" ? '<a href="http://help-ru.tilda.ws" target="_blank">Справочный центр</a>' : '<a href="http://help.tilda.ws" target="_blank">Help center</a>') +'</div></div>';
			str += '	<div class="tc-help__header-close-wrapper" onclick="closeHelpPanel();"><div class="tc-help__header-close"><img src="/tpl/img/page/tp-08-close.svg" class="tc-help__header-close-ico"></div></div>';
			str += '</div>';

			if(typeof window.showsearch!='undefined' && window.showsearch=='yes' && lang=='RU'){
			str += '<div class="tc-help__search" style="padding-top:15px;padding-bottom: 15px;background-color: #fa8669;">';
			//str += '	<div style="padding-left:20px;padding-bottom:5px;font-size:20px;color:#fff;">'+(lang=='RU'?'Введите вопрос или ключевое слово:':'Enter question or keyword:')+'</div>';
			str += '	<div class="tc-help__search-wrapper">';
			str += '	<input type="text" class="tc-help__search-input t-searcher" value="" placeholder="'+(lang=='RU'?'Введите вопрос или ключевое слово':'Enter question or keyword')+'" data-attr-lang="'+(lang=='RU'?'RU':'EN')+'"><img src="/tpl/img/td-search.svg" style="width:15px;opacity:0.3;position:absolute; top:18px;left:15px;">';
			str += '	<div class="t-searcher-close" style="position:absolute;cursor:pointer;width:15px;height:15px;top:15px;right:5px;display:none;"><img class="t-searcher-close-img" style="opacity:0.8; width:15px; height:15px;" src="https://answers.tilda.cc/src/images/Tilda_Icons_27bu_8.svg"></div>';
			str += '	<div class="t-searcher-load" style="display:none;position:absolute;cursor:pointer;width:15px;height:15px;top:15px;right:5px;"><img class="t-searcher-load-img" style=" opacity:0.5; width: 15px; height:15;" src="https://answers.tilda.cc/src/images/arrows_rotate.svg"></div>';
			str += '	</div>';
			str += '</div>';
	        $.getScript('https://answers.tilda.cc/src/js/searcher-popup.js', function() {
	        });
			}

			str += '<div class="tc-help__types">';
			$.each(topics, function(inx, topic) {
			str += '<div class="tc-help__type-body">';
			str += '<a href="javascript:tc_help_clicktopic('+inx+');" target="_blank" class="tc-help__type"><div class="tc-help__type-title-wrapper"><div class="tc-help__type-title">'+topic.title+'</div></div><div class="tc-help__type-icon-wrapper"><div class="tc-help__type-icon-plus"><img src="/tpl/img/page/tp-12-down.svg" style="width:15px;"></div><div class="tc-help__type-icon-minus"><img src="/tpl/img/page/tp-14-line.svg" style="opacity:0.3;"></div></div></a>';
			str += '<div class="tc-help__type-questions tc-help__type-questions__'+inx+'">';
			$.each(topic.items, function(index, q) {
			str += '<a href="'+q.link+'" target="_blank" class="tc-help__type-quesition tc-help__item">'+q.title+'</a>';
			});
			str += '</div>';
			str += '</div>';
			});
			str += '</div>';

			str += '<div class="tc-help__items">';
			str += '<div class="tc-help__items-caption">'+ (lang=="RU" ? 'Частые вопросы' : 'F.A.Q.') +'</div>';
			$.each(q, function(index, v) {
			str += '<a href="'+v.link+'" target="_blank" class="tc-help__item">'+v.title+'</a>';
			});
			str += '</div>';


		str += '</div>';

		str += '<div class="tc-help__footer">';
		str += '<div class="tc-help__footer-wrapper">';
		str += '<table style="width:100%;"><tr><td>';
		str += '<div class="tc-help__send-btn-hint">'+(lang=="RU" ? "Не нашли ответ на свой вопрос?" : "Didn't find the answer to your question?")+'</div>';
		str += '</td><td style="text-align:right;">';
		str += '<a href="/identity/chat/" class="tc-help__send-btn" target="_blank" style="white-space:nowrap;">'+(lang=="RU" ? "Написать нам" : "Send us a message")+'</a>';
		str += '</td></tr></table>';
		str += '</div>';
		str += '</div>';

		str += '</div>';
		$('body').append(str);

		$(document).on('keyup',tc_help_keyUpFunc);

		if(typeof window.showsearch!='undefined' && window.showsearch=='yes' && lang=='RU'){
			$('.tc-help__search-input').focus();
		}

	}

	function closeHelpPanel(){
		$('.tc-help').remove();
		$('.t-help-bubble').css('display','block');
	}

	function tc_help_keyUpFunc(e) {
	    if (e.keyCode == 27) {
	        closeHelpPanel();
	        $(document).off('keyup',tc_help_keyUpFunc);
	    }
	}

	function tc_help_clicktopic(inx){
		var el=$('.tc-help__type-questions__'+inx);

		if(el.hasClass('tc-help__type-questions__open')){
			el.removeClass('tc-help__type-questions__open');
		}else{
			$('.tc-help__type-questions').removeClass('tc-help__type-questions__open');
			el.addClass('tc-help__type-questions__open');
		}
	}

	function str_stripTags(str){
		if (typeof str!='object' && str) {
			str = str.replace(/(<([^>]+)>)/ig,"");
		}
		return str;
	}

	function getCSRF(){
		var t=$('#csrf').attr('content');
		if(typeof t!='undefined' && t!=''){
			return t;
		}
		return 'NONE';
	}
